$.fn.toggleAria=function(t){return this.each(function(){var e=$(this),i="aria-"+t,s=e.attr(i);e.attr(i,"true"===s?"false":"true")})};var OSLC={dasherize:function(t){return _.dasherize(t).replace(/^ms-/,"-ms-")},funcFold:function(t){return function(e,i){return e+t(i)}},templateFold:function(t){return function(e,i){return e+_.template(t,i)}},mediaQueries:{},modules:{},transitionEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"}};_.forEach(["screen","landscape","portrait","hand-up","hand-only","knee-up","knee-only","desk-up","desk-only","workstation-up","workstation-only","neckbeard-up","neckbeard-only"],function(t){$("head").append('<meta class="oslc-mq-'+t+'" />'),OSLC.mediaQueries[t]=$(".oslc-mq-"+t).css("font-family").split(/\/|\\|'|"/g).join("")}),OSLC.supportsTransitions=Modernizr&&"csstransitions"in Modernizr&&Modernizr.csstransitions&&{end:OSLC.transitionEventNames[Modernizr.prefixed("transition")]},OSLC.supportsAcceleratedTransitions=Modernizr&&"csstransforms3d"in Modernizr&&Modernizr.csstransforms3d,$(document).on("click","[data-toggle-class]",function(t){var e=$(this);e.attr("data-target")&&(_.forEach(e.attr("data-target").split(","),function(t){var i;i=t.indexOf("|self|")>-1?e:t.indexOf("|parent")>-1?e.parent():$(t),i.length&&i.toggleClass(e.attr("data-toggle-class").split(".").join(""))}),t.preventDefault())}),$(function(){var t=_.template('<div class="fluid-video" <%= style %> ><%= video %></div>');$('iframe[src*="youtube"], iframe[src*="vimeo"]').not(".no-resize").each(function(e,i){i.outerHTML=t({style:'style="padding-bottom: '+i.height/i.width*100+'%;"',video:i.outerHTML})})}),function(t,e,i,s){var n=_.create(OSLC,{name:"Bartender",defaultStates:{filter:{on:"All",label:"All"},sort:{on:"order",direction:"asc",label:"Original order"}},bartenderItemTemplate:_.template('<a href="#" class="item hasFlagInline"><div class="flag"><div class="image"><i class="icon grunticon-menu-<%= name %>"></i></div><div class="body"><span id="<%= name %>Body" data-text="<%= _.capitalize(name) %>"><%= _.capitalize(name) %></span> &#9662;</div></div></a>'),init:function(e){this.els={menu:t(e),listing:t("#main").find(".listing").first()},this.constructMenu(),this.bindings(),this.update()},update:function(){var e=this,i=this.els.listing.find("[data-filter-target]"),s,n={duration:200,easing:"easeOutCubic"};_.forEach(this.state,function(i,s){t(e.drops[s].content).find(".item").removeClass("current").filter('[data-label="'+i.label+'"]').addClass("current"),t("#"+s+"Body").html(t("#"+s+"Body").data("text")+(_.contains(["All","Original order"],i.label)?"":': <span class="activeFilter">'+i.label+"</span>"))}),s=i.filter(function(){var i=t(this);return _(e.state).omit("sort").mapValues("on").every(function(t,e){return i.is("[data-filter-"+e+'~="'+t+'"]')})}),i.not(s).filter(":visible").velocity({opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],transformOriginZ:[0,0],scaleX:.5,scaleY:.5,translateZ:0},_.defaults({complete:function(){t(this).addClass("hidden")}},n)),s.filter(":hidden").removeClass("hidden").velocity({opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],transformOriginZ:[0,0],scaleX:[1,.625],scaleY:[1,.625],translateZ:[0,0]},n),i.tsort({data:this.state.sort.on,order:this.state.sort.direction})},bindings:function(){var e=this;t(i).on("click","[data-update]",function(i){i.preventDefault();var s=t(this),n=s.data();s.hasClass("current")||(e.state[n.update]=_.omit(n,"update"),e.update())})},constructMenu:function(){this.state={},this.drops={},this.els.cards=this.els.listing.find(".card").closest(".column");var t=this.els.menu.data("controls");return t?void _.forEach(t.split(","),this.buildControl,this):void console.log("No controls specified for Bartender. Bailing.")},buildControl:function(e){var i=this.els.cards,s,n=this.listFilterMenuItems(e);return n.length<2?void console.log("Control for ",e," did not have enough items. Bailing."):(s=t(this.bartenderItemTemplate({name:e})).appendTo(this.els.menu),this.state[e]=this.defaultStates[e]||this.defaultStates.filter,"sort"===e?i.attr("data-order",function(){return t(this).index()}):i.attr("data-filter-target","true").attr("data-filter-"+e,function(){return _.reduce(t(this).find('[data-filter-on="'+e+'"]'),function(e,i){return e+" "+_.classify(_.trim(t(i).text()))},"All")}),this.drops[e]=new Drop({target:s[0],classes:"drop-theme-oslc",toggleBodyClass:!1,tetherOptions:{attachment:"top left",targetAttachment:"top left",optimizations:{moveElement:!1}}}),this.buildDropMenu(e,n),void this.drops[e].on("open",function(){t(this.content).find(".current").velocity("callout.pulse",{duration:400})}))},listFilterMenuItems:function(t){var e=[];return"sort"===t?e=[[{on:"date",direction:"desc"},"Newest"],[{on:"date",direction:"asc"},"Oldest"],[{on:"order",direction:"asc"},"Original order"]]:(e=_(this.els.listing.find('[data-filter-on="'+t+'"]')).groupBy("textContent").map(function(t,e){var i=t[0],s=_.trim(e);return[{count:t.length,label:s,on:_.classify(s)},i.innerHTML,i.href,i.className]}).value(),e.push([{count:this.els.cards.length,on:"All"},"All"])),e},buildDropMenu:function(e,i){var s=t("<div>").addClass("menu tensed"),n=this.templateFold('<a class="item" href="<%= href %>" data-update="'+e+'" <% _.each(data, function(val,key) { %>data-<%= key %>="<%= val %>" <% }); %>><span class="<%= classes %>"><%= html %></span></a>'),a=function(t){var e=["data","html","href","classes"],i=_.defaults(_.zipObject(e,t),_.zipObject(e,[{},"Label not found","#",""]));return i.data.label||(i.data.label=i.html),i};s.html(_.reduce(i.map(a),n,"")),"sort"!==e&&s.find(".item").tsort({data:"count",order:"desc"},{data:"label"}),t(this.drops[e].content).html(s),this.drops[e].position()}});OSLC.modules.bartender=n,t(i).ready(function(){t("[data-bartender]").each(function(){t(this).data("bartender",_.create(n)).data("bartender").init(this)})})}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=_.create(OSLC,{name:"Sextant",els:{nav:t("#nav"),main:t("#main"),toggle:t("#navToggle"),allToggled:t("#nav,#main,#navToggle,.close-nav"),close:t(".close-nav")},classes:{open:"nav-is-open"},is_open:function(){return this.els.main.hasClass(this.classes.open)},init:function(){console.log("Initializing Sextant global navigation"),this.els.nav.insertBefore(this.els.main),this.set_main_slide_distance(),this.bindings()},bindings:function(){var i=this;this.els.toggle.add(this.els.close).on("click.oslc.sextant",function(t){t.preventDefault(),i.toggle()});var s=_.once(function(){console.log("doing the one-time injection in case we started too large"),i.set_main_slide_distance(),t(e).trigger("lateStyleInjected.oslc.sextant")});!Modernizr.mq(i.mediaQueries["hand-only"])&&t(e).on("resize.oslc.sextant orientationchange.oslc.sextant",function(){Modernizr.mq(i.mediaQueries["hand-only"])&&s()})},open:function(){this.toggle("open")},close:function(){this.toggle("close")},toggle:function(i){i=i||(this.is_open()?"close":"open");var s="open"===i;console.log(i),t(e).trigger(i+".oslc.sextant"),this.els.allToggled[s?"addClass":"removeClass"](this.classes.open)},set_main_slide_distance:function(t){var e=this.mediaQueries["hand-only"];if(Modernizr.mq(e)){var i="@media "+e,s={};s[i]=["#main."+this.classes.open];var n=t||this.els.nav.outerHeight()+"px",a=Modernizr.csstransforms?Modernizr.prefixed("transform"):"top";a=this.dasherize(a);var r={};r[a]=Modernizr.csstransforms?"translate(0,"+n+")":n,vein.inject([s],r),console.log("injecting distance of "+n)}}});OSLC.modules.sextant=n,t(i).ready(function(){n.init()})}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=0,a=_.create(OSLC,{name:"Whirligig",classes:{active:"active"},aria:{tab:{off:{"aria-expanded":"false","aria-selected":"false",tabindex:"-1"},on:{"aria-expanded":"true","aria-selected":"true",tabindex:"0"}},tabpanel:{off:{"aria-hidden":"true",tabindex:"-1"},on:{"aria-hidden":"false",tabindex:"0"}}},init:function(e){console.log("Initializing Whirligig for #"+e.id);var i=this;this.el=t(e),this.controls=t(".tab",this.el).each(function(){var e=this.getAttribute("href"),s="whirligig-tab-"+n++;t(this).attr(_.extend({role:"tab",id:s,"aria-controls":e.replace("#","")},i.aria.tab.off)),t(e).attr(_.extend({role:"tabpanel","aria-labelledby":s},i.aria.tabpanel.off))}),this.control_wrap=t(".tabs",this.el).attr("role","tablist"),this.controls_area=t(".controls",this.el),this.indicator=t('<ins class="indicator"></ins>').attr("role","presentation").appendTo(this.control_wrap),this.wrapper=t(".panels",this.el),this.panels=t(".panel",this.el),this.controls.hasClass(this.classes.active)||this.controls.first().addClass(this.classes.active),this.to(this.controls.filter("."+this.classes.active).attr("href"),!1),this.bindings()},bindings:function(){var e=this;this.controls.on("click.oslc.whirligig",function(i){i.preventDefault(),t(this).hasClass(e.classes.active)||e.to(t(this).attr("href"),!0)}).on("keydown.oslc.whirligig",function(i){t.inArray(i.keyCode,[37,38,39,40])>-1&&i.preventDefault(),(37===i.keyCode||38===i.keyCode)&&e.prev(!0),(39===i.keyCode||40===i.keyCode)&&e.next(!0)})},next:function(t){var e=this.panels.filter("."+this.classes.active),i=e.is(this.panels.last())?this.panels.first():e.next();return this.to("#"+i[0].id,t),!1},prev:function(t){var e=this.panels.filter("."+this.classes.active),i=e.is(this.panels.first())?this.panels.last():e.prev();return this.to("#"+i[0].id,t),!1},to:function(e,i){var s,n,a,r,o;s=t(e),n=s.index(),a="-"+100*n+"%",r=this.supportsAcceleratedTransitions?Modernizr.prefixed("transform"):"left",o=this.supportsAcceleratedTransitions?"translate3d("+a+",0,0)":a,s.hasClass(this.classes.active)||(this.el.trigger({type:"slideStart",relatedTarget:s[0]}),this.wrapper.css(r,o).find("> ."+this.classes.active).removeClass(this.classes.active).attr(this.aria.tabpanel.off),s.addClass(this.classes.active).attr(this.aria.tabpanel.on),this.controls.removeClass(this.classes.active).attr(this.aria.tab.off).filter('[href="'+e+'"]').addClass(this.classes.active).attr(this.aria.tab.on),this.move_indicator(),i&&this.controls.filter("."+this.classes.active).focus())},move_indicator:function(){var e,i,s,n,a;e=this.controls.filter("."+this.classes.active),i=e.position().left+"px",s=e.width()-(e.is(":first-child")?0:4)+"px",n=this.supportsAcceleratedTransitions?Modernizr.prefixed("transform"):"left",a=this.supportsAcceleratedTransitions?"translate3d("+i+",0,0)":i,this.supportsTransitions&&this.indicator.filter(":visible").one(this.supportsTransitions.end,function(){t(this).removeClass("moving")}).addClass("moving"),this.indicator.css("width",s).css(n,a)}});OSLC.modules.whirligig=a,t(function(){t("[data-whirligig]").each(function(){t(this).data("whirligig",_.create(a)).data("whirligig").init(this)})})}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=_.create(OSLC,{name:"Doubtfire",els:{nav:t("#nav")},init:function(){console.log("Initialize Doubtfire nanny class"),this.bindings()},bindings:function(){var i=this.modules.sextant,s=this.els.nav.data("whirligig"),n=this;if(i&&s){console.log("DOUBTFIRE: Initialize Sextant + Whirligig interactions"),this.els.nav.on("slideStart",function(t){n.set_main_slide_distance(t.relatedTarget)});var a=_.once(function(){console.log("fired the resize fixes. shouldnt see this again!"),s.move_indicator(),n.set_main_slide_distance()});t(e).on("open.oslc.sextant lateStyleInjected.oslc.sextant orientationchange.oslc.sextant",function(){Modernizr.mq(OSLC.mediaQueries["hand-only"])&&a()})}},set_main_slide_distance:function(e){var i=this.els.nav.data("whirligig");e=e?t(e):i.panels.filter(".active");var s=i.controls_area.outerHeight()+e.outerHeight()+"px";this.modules.sextant.set_main_slide_distance(s)}});t(i).ready(function(){n.init()})}(jQuery,this,this.document);