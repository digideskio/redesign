$.fn.toggleAria=function(t){return this.each(function(){var e=$(this),i="aria-"+t,s=e.attr(i);e.attr(i,"true"===s?"false":"true")})};var OSLC={dasherize:function(t){return _.dasherize(t).replace(/^ms-/,"-ms-")},funcFold:function(t){return function(e,i){return e+t(i)}},templateFold:function(t){return function(e,i){return e+_.template(t,i)}},mediaQueries:{},modules:{},transitionEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"}};_.forEach(["screen","landscape","portrait","hand-up","hand-only","knee-up","knee-only","desk-up","desk-only","workstation-up","workstation-only","neckbeard-up","neckbeard-only"],function(t){$("head").append('<meta class="oslc-mq-'+t+'" />'),OSLC.mediaQueries[t]=$(".oslc-mq-"+t).css("font-family").split(/\/|\\|'|"/g).join("")}),OSLC.supportsTransitions=Modernizr&&"csstransitions"in Modernizr&&Modernizr.csstransitions&&{end:OSLC.transitionEventNames[Modernizr.prefixed("transition")]},OSLC.supportsAcceleratedTransitions=Modernizr&&"csstransforms3d"in Modernizr&&Modernizr.csstransforms3d,$(document).on("click","[data-toggle-class]",function(t){var e=$(this);e.attr("data-target")&&(_.forEach(e.attr("data-target").split(","),function(t){var i;i=t.indexOf("|self|")>-1?e:t.indexOf("|parent")>-1?e.parent():$(t),i.length&&i.toggleClass(e.attr("data-toggle-class").split(".").join(""))}),t.preventDefault())}),$(function(){var t=_.template('<div class="fluid-video" <%= style %> ><%= video %></div>');$('iframe[src*="youtube"], iframe[src*="vimeo"]').not(".no-resize").each(function(e,i){i.outerHTML=t({style:'style="padding-bottom: '+i.height/i.width*100+'%;"',video:i.outerHTML})})}),function(t,e,i,s){var n=_.create(OSLC,{name:"Bartender",els:{menu:t("#bartender"),listing:t("#main").find(".listing").first()},state:{filter:"All",sort:{on:"order",direction:"asc",label:"Original order"}},init:function(){this.constructMenu(),this.bindings(),this.update()},update:function(){var e=this,i=this.els.listing.find("[data-filter-on]");t(this.els.filterMenu.content).find(".item").removeClass("current").filter('[data-tagname="'+this.state.filter+'"]').addClass("current");var s='[data-filter-on~="'+_.classify(this.state.filter)+'"]',n=i.filter(s).filter(":hidden"),a=i.not(s).filter(":visible");a.velocity({opacity:[0,1],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],transformOriginZ:[0,0],scaleX:.5,scaleY:.5,translateZ:0},{duration:200,easing:"easeOutCubic",complete:function(){t(this).addClass("hidden")}}),n.removeClass("hidden").velocity({opacity:[1,0],transformOriginX:["50%","50%"],transformOriginY:["50%","50%"],transformOriginZ:[0,0],scaleX:[1,.625],scaleY:[1,.625],translateZ:[0,0]},{duration:200,easing:"easeOutCubic"}),t("#filterBody").html(t("#filterBody").data("text")+("All"===e.state.filter?"":': <span class="activeFilter">'+e.state.filter+"</span>")),t(this.els.sortMenu.content).find(".item").removeClass("current").filter(_.template('[data-sort="<%= on %>"][data-direction="<%= direction %>"]',this.state.sort)).addClass("current"),i.tsort({data:this.state.sort.on,order:this.state.sort.direction}),t("#sortBody").html(t("#sortBody").data("text")+("Original order"===e.state.sort.label?"":': <span class="activeFilter">'+e.state.sort.label+"</span>"))},bindings:function(){var e=this;t(i).on("click","[data-filter]",function(i){i.preventDefault();var s=t(this);s.hasClass("current")||(e.state.filter=s.data("tagname"),e.update())}).on("click","[data-sort]",function(i){i.preventDefault();var s=t(this);s.hasClass("current")||(e.state.sort={on:s.data("sort"),direction:s.data("direction"),label:s.text()},e.update())})},constructMenu:function(){_.each(this.els.menu.data("bartender").split(","),function(t){_.has(this,"build_"+t)&&this["build_"+t]()},this)},build_filter:function(){var e=t(this.buildMenuItem("filter")).appendTo(this.els.menu),i=t("<div>").addClass("menu tensed"),s=this.els.listing.find(".tag"),n=this.els.listing.find(".card").closest(".column").attr("data-filter-on",function(){return _.reduce(t(this).find(".tag"),function(e,i){return e+" "+_.classify(_.trim(t(i).text()))},"All")}).length,a=_(s).groupBy("textContent").map(function(t){var e=t[0],i=_.trim(e.textContent);return{count:t.length,link:e.href||"#",html:e.innerHTML,classes:e.className,text:i,filter:_.classify(i)}}).value();a.push({count:n,link:"#",html:"All",text:"All",filter:"All",classes:""});var r=this.templateFold('<a class="item" href="<%= link %>" data-count="<%= count %>" data-tagname="<%= text %>" data-filter="<%= filter %>"><span class="count"><%= count %> &times;</span> <span class="<%= classes %>"><%= html %></span></a>');i.append(_.reduceRight(a,r,"")).find(".item").tsort({data:"count",order:"desc"},{data:"tagname"}),this.els.filterMenu=new Drop({target:e[0],classes:"drop-theme-oslc",content:i[0],tetherOptions:{attachment:"top left",targetAttachment:"top left"}}),this.els.filterMenu.on("open",function(){t(this.content).find(".current").velocity("callout.pulse",{duration:400})})},build_sort:function(){var e=t(this.buildMenuItem("sort")).appendTo(this.els.menu),i=[{text:"Newest",sort:"date",direction:"desc",classes:""},{text:"Oldest",sort:"date",direction:"asc",classes:""},{text:"Original order",sort:"order",direction:"asc",classes:"current"}],s=t("<div>").addClass("menu").append(_.reduce(i,this.templateFold('<a class="item <%= classes %>" href="#" data-sort="<%= sort %>" data-direction="<%= direction %>"><%= text %></a>'),""));this.els.listing.find(".column").each(function(){t(this).attr("data-order",t(this).index())}),this.els.sortMenu=new Drop({target:e[0],classes:"drop-theme-oslc",content:s[0],tetherOptions:{attachment:"top left",targetAttachment:"top left"}}),this.els.sortMenu.on("open",function(){t(this.content).find(".current").velocity("callout.pulse",{duration:400})})},buildMenuItem:function(t){return _.template('<a href="#" data-has-drop="true" class="item hasFlagInline"><div class="flag"><div class="image"><i class="icon grunticon-menu-<%= name %>"></i></div><div class="body"><span id="<%= name %>Body" data-text="<%= capName %>"><%= capName %></span> &#9662;</div></div></a>',{name:t,capName:_.capitalize(t)})}});n.init()}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=_.create(OSLC,{els:{nav:t("#nav"),main:t("#main"),toggle:t("#navToggle"),allToggled:t("#nav,#main,#navToggle,.close-nav"),close:t(".close-nav")},classes:{open:"nav-is-open"},is_open:function(){return this.els.main.hasClass(this.classes.open)},init:function(){this.els.nav.insertBefore(this.els.main),this.set_main_slide_distance(),this.bindings()},bindings:function(){var i=this;this.els.toggle.add(this.els.close).on("click.oslc.sextant",function(t){t.preventDefault(),i.toggle()});var s=_.once(function(){console.log("doing the one-time injection in case we started too large"),i.set_main_slide_distance(),t(e).trigger("lateStyleInjected.oslc.sextant")});!Modernizr.mq(i.mediaQueries["hand-only"])&&t(e).on("resize.oslc.sextant orientationchange.oslc.sextant",function(){Modernizr.mq(i.mediaQueries["hand-only"])&&s()})},open:function(){this.toggle("open")},close:function(){this.toggle("close")},toggle:function(i){i=i||(this.is_open()?"close":"open");var s="open"===i;console.log(i),t(e).trigger(i+".oslc.sextant"),this.els.allToggled[s?"addClass":"removeClass"](this.classes.open)},set_main_slide_distance:function(t){var e=this.mediaQueries["hand-only"];if(Modernizr.mq(e)){var i="@media "+e,s={};s[i]=["#main."+this.classes.open];var n=t||this.els.nav.outerHeight()+"px",a=Modernizr.csstransforms?Modernizr.prefixed("transform"):"top";a=this.dasherize(a);var r={};r[a]=Modernizr.csstransforms?"translate(0,"+n+")":n,vein.inject([s],r),console.log("injecting distance of "+n)}}});n.init(),OSLC.modules.sextant=n}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=0,a=_.create(OSLC,{classes:{active:"active"},aria:{tab:{off:{"aria-expanded":"false","aria-selected":"false",tabindex:"-1"},on:{"aria-expanded":"true","aria-selected":"true",tabindex:"0"}},tabpanel:{off:{"aria-hidden":"true",tabindex:"-1"},on:{"aria-hidden":"false",tabindex:"0"}}},init:function(e){var i=this;this.el=t(e),this.controls=t(".tab",this.el).each(function(){var e=this.getAttribute("href"),s="whirligig-tab-"+n++;t(this).attr(_.extend({role:"tab",id:s,"aria-controls":e.replace("#","")},i.aria.tab.off)),t(e).attr(_.extend({role:"tabpanel","aria-labelledby":s},i.aria.tabpanel.off))}),this.control_wrap=t(".tabs",this.el).attr("role","tablist"),this.controls_area=t(".controls",this.el),this.indicator=t('<ins class="indicator"></ins>').attr("role","presentation").appendTo(this.control_wrap),this.wrapper=t(".panels",this.el),this.panels=t(".panel",this.el),this.controls.hasClass(this.classes.active)||this.controls.first().addClass(this.classes.active),this.to(this.controls.filter("."+this.classes.active).attr("href"),!1),this.bindings()},bindings:function(){var e=this;this.controls.on("click.oslc.whirligig",function(i){i.preventDefault(),t(this).hasClass(e.classes.active)||e.to(t(this).attr("href"),!0)}).on("keydown.oslc.whirligig",function(i){t.inArray(i.keyCode,[37,38,39,40])>-1&&i.preventDefault(),(37===i.keyCode||38===i.keyCode)&&e.prev(!0),(39===i.keyCode||40===i.keyCode)&&e.next(!0)})},next:function(t){var e=this.panels.filter("."+this.classes.active),i=e.is(this.panels.last())?this.panels.first():e.next();return this.to("#"+i[0].id,t),!1},prev:function(t){var e=this.panels.filter("."+this.classes.active),i=e.is(this.panels.first())?this.panels.last():e.prev();return this.to("#"+i[0].id,t),!1},to:function(e,i){var s,n,a,r,o;s=t(e),n=s.index(),a="-"+100*n+"%",r=this.supportsAcceleratedTransitions?Modernizr.prefixed("transform"):"left",o=this.supportsAcceleratedTransitions?"translate3d("+a+",0,0)":a,s.hasClass(this.classes.active)||(this.el.trigger({type:"slideStart",relatedTarget:s[0]}),this.wrapper.css(r,o).find("> ."+this.classes.active).removeClass(this.classes.active).attr(this.aria.tabpanel.off),s.addClass(this.classes.active).attr(this.aria.tabpanel.on),this.controls.removeClass(this.classes.active).attr(this.aria.tab.off).filter('[href="'+e+'"]').addClass(this.classes.active).attr(this.aria.tab.on),this.move_indicator(),i&&this.controls.filter("."+this.classes.active).focus())},move_indicator:function(){var e,i,s,n,a;e=this.controls.filter("."+this.classes.active),i=e.position().left+"px",s=e.width()-(e.is(":first-child")?0:4)+"px",n=this.supportsAcceleratedTransitions?Modernizr.prefixed("transform"):"left",a=this.supportsAcceleratedTransitions?"translate3d("+i+",0,0)":i,this.supportsTransitions&&this.indicator.filter(":visible").one(this.supportsTransitions.end,function(){t(this).removeClass("moving")}).addClass("moving"),this.indicator.css("width",s).css(n,a)}});t(function(){t("[data-whirligig]").each(function(){t(this).data("whirligig",_.create(a)).data("whirligig").init(this)})}),OSLC.modules.whirligig=a}(jQuery,this,this.document),function(t,e,i,s){"use strict";var n=_.create(OSLC,{els:{nav:t("#nav")},init:function(){this.bindings()},bindings:function(){var i=this.modules.sextant,s=this.els.nav.data("whirligig"),n=this;if(i&&s){this.els.nav.on("slideStart",function(t){n.set_main_slide_distance(t.relatedTarget)});var a=_.once(function(){console.log("fired the resize fixes. shouldnt see this again!"),s.move_indicator(),n.set_main_slide_distance()});t(e).on("open.oslc.sextant lateStyleInjected.oslc.sextant orientationchange.oslc.sextant",function(){Modernizr.mq(OSLC.mediaQueries["hand-only"])&&a()})}},set_main_slide_distance:function(e){var i=this.els.nav.data("whirligig");e=e?t(e):i.panels.filter(".active");var s=i.controls_area.outerHeight()+e.outerHeight()+"px";this.modules.sextant.set_main_slide_distance(s)}});n.init()}(jQuery,this,this.document);