<!DOCTYPE html><html lang="en" class="no-js base"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Providing a delegated UI for selection and search</title><meta name="combinedcss" content="http://oslc.github.io/redesign/assets/css/build/combined.min.css"/><meta name="enhancedjs" content="http://oslc.github.io/redesign/assets/js/build/enhanced.min.js"/><meta name="grunticons" content="http://oslc.github.io/redesign/assets/icons/build/icons.svg.css,http://oslc.github.io/redesign/assets/icons/build/icons.png.css,http://oslc.github.io/redesign/assets/icons/build/icons.fallback.css"/><style type="text/css">.copy>p,.copy>ul{margin-bottom:1.4375em;margin-top:0}.close-nav,.enhanced .nav{position:absolute}.block,.block.icon,.project-name{display:block}.icon,.inline li{display:inline-block;vertical-align:baseline;zoom:1}.inline,.menu .items{margin-top:0;margin-right:0;margin-bottom:0;margin-left:0;padding-top:0;padding-right:0;padding-bottom:0;padding-left:0;list-style-type:none;list-style-position:initial;list-style-image:initial}.icon{vertical-align:top;background-repeat:no-repeat no-repeat}.toggle{text-align:center}.toggle .text{display:block}.copy li,.copy>p{max-width:720px}.ir{text-indent:100%;white-space:nowrap;overflow-x:hidden;overflow-y:hidden}.sr-only{border-top-width:0;border-right-width:0;border-bottom-width:0;border-left-width:0;border-style:initial;border-color:initial;clip:rect(0 0 0 0);height:1px;margin-top:-1px;margin-right:-1px;margin-bottom:-1px;margin-left:-1px;overflow-x:hidden;overflow-y:hidden;padding-top:0;padding-right:0;padding-bottom:0;padding-left:0;position:absolute;width:1px}.copy>h2{font-size:2rem;line-height:1.1875}.image-link{text-decoration:none}html{box-sizing:border-box}*{box-sizing:inherit}header,main,nav,section{display:block}html{font-family:'Helvetica Neue',Helvetica,Roboto,Arial,sans-serif}body{margin-top:0;margin-right:0;margin-bottom:0;margin-left:0}a{background-image:initial;background-attachment:initial;background-origin:initial;background-clip:initial;background-color:transparent;background-position:initial initial;background-repeat:initial initial}abbr[title]{border-bottom-width:1px;border-bottom-style:dotted;border-bottom-color:initial}strong{font-weight:700}small{font-size:80%}.grid{font-family:FreeSans,Arimo,'Droid Sans',Helvetica,Arial,sans-serif;letter-spacing:-.31em;word-spacing:-.43em}.grid.pulled{margin-left:-.6875rem;margin-right:-.6875rem}@media only screen and (min-width:64.0625em){.grid.pulled{margin-left:-1.1875rem;margin-right:-1.1875rem}}.column{font-family:'Helvetica Neue',Helvetica,Roboto,Arial,sans-serif;letter-spacing:normal;word-spacing:normal;display:inline-block;zoom:1;vertical-align:top;padding-left:.6875rem;padding-right:.6875rem}@media only screen and (min-width:64.0625em){.column{padding-left:1.1875rem;padding-right:1.1875rem}}.hand-full{width:100%}.no-js .desk-up{display:none!important}.body{overflow-x:hidden;overflow-y:hidden;zoom:1}.flag,.strip{display:table}.flag>.body,.flag>.image,.strip>.body,.strip>.image,.strip>.toggle{display:table-cell;vertical-align:middle}.flag>.body,.strip>.body{width:100%}html{font-size:100%}.sticky-footer-body{background-color:#444}.copy a{color:#4178b4;-webkit-transition-property:color;-webkit-transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(0.215,.61,.355,1);-webkit-transition-delay:initial}.copy{line-height:1.4375}.copy>:first-child{margin-top:0}.copy>h2{font-weight:400;margin-top:.71em;margin-bottom:.6em;border-left-width:8px;border-left-style:solid;padding-left:3px;margin-left:-11px;border-top-color:#315a87;border-right-color:#315a87;border-bottom-color:#315a87;border-left-color:#315a87}@media only screen and (min-width:64.0625em){.copy>h2{padding-left:11px;margin-left:-19px}}.copy>ul{padding-left:1.5rem}.copy li{margin-bottom:.375rem;margin-top:.375rem}.menu .item{padding-top:.6875rem;padding-right:.5rem;padding-bottom:.6875rem;padding-left:.5rem;display:block;color:#444}.menu .item,.menu a{text-decoration:none;-webkit-transition-property:background-color;-webkit-transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(0.215,.61,.355,1);-webkit-transition-delay:initial}.menu.primary{background-color:#3e4b5b}.menu.primary .item,.menu.primary a{color:#fff}.menu.primary .current{background-color:#323c49!important}.inline li{margin-right:11px}.toggle{text-decoration:none;-webkit-transition-property:background-color;-webkit-transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(0.215,.61,.355,1);-webkit-transition-delay:initial}.toggle .text{color:#fff;font-size:11px;line-height:1;margin-top:.25rem}.banner{background-color:#3e4b5b;box-shadow:rgba(0,0,0,.15625)0 2px 3px;z-index:5}.banner .toggle{padding-top:.25rem;padding-right:.6875rem;padding-bottom:.25rem;padding-left:.6875rem;border-right-width:1px;border-right-style:solid;border-right-color:#4c5c70}.banner .image-link{margin-left:.5rem;padding-top:.25rem;padding-bottom:.25rem}.banner .logo-text{margin-left:.625rem}.logo-text{display:block;color:#fff}.project-name{margin-top:.25rem}abbr.grunticon-wordmark-med,abbr.grunticon-wordmark-small{border-bottom-width:0!important;border-bottom-style:initial!important;border-bottom-color:initial!important}.bar,.main>.header .title{padding-left:11px;padding-right:11px}@media only screen and (min-width:64.0625em){.bar,.main>.header .title{padding-left:19px;padding-right:19px}}.main{background-color:#fff}.main>.header{background-color:#fff;color:#444;margin-top:19px;margin-bottom:13px}.main>.header .title{margin-top:0;margin-right:0;margin-bottom:0;margin-left:0;padding-top:5.5px;padding-bottom:5.5px;font-weight:400;font-size:1.6875rem;line-height:1.1}@media only screen and (min-width:64.0625em){.main>.header .title{font-size:2rem;line-height:1.1875}}.bar{padding-top:16px;padding-bottom:16px}.footer[role=contentinfo] a{-webkit-transition-property:color;-webkit-transition-duration:.2s;-webkit-transition-timing-function:cubic-bezier(0.215,.61,.355,1);-webkit-transition-delay:initial;text-decoration:none;color:#203c5a}.footer[role=contentinfo] p{margin-top:0;margin-right:0;margin-bottom:0;margin-left:0}.footer[role=contentinfo] .social .icon{margin-right:5px;margin-bottom:5px}.footer[role=contentinfo] .copyright{margin-top:8px}@media only screen and (min-width:40.0625em){.knee-major{width:70.72%}.knee-minor{width:29.28%}}@media only screen and (max-width:90em) and (min-width:64.0625em){.knee-down{display:none!important}}@media only screen and (min-width:40.0625em){.off-canvas-wrap{position:relative}}.enhanced .nav{z-index:2}@media only screen and (min-width:40.0625em){.enhanced .nav{width:216px;top:0;bottom:0;background-color:#3e4b5b;box-shadow:rgba(0,0,0,.109375)2px 0 3px;overflow-x:auto;overflow-y:auto}.enhanced .nav .panels{position:absolute;top:0;left:0;right:0;bottom:0}.enhanced .nav .panel{position:absolute;top:0;bottom:0;z-index:1}}.enhanced .nav .logo-text{text-align:center;margin-top:.6875rem}.enhanced .nav .project-name{margin-bottom:.6875rem}@media only screen and (min-width:40.0625em){#main_menu{width:216px;background-color:#3e4b5b}}.main{position:relative;z-index:1}@media only screen and (min-width:64.0625em){.main{margin-left:216px}}.close-nav{top:0;right:0;left:0;height:100%;display:none;background-color:rgba(0,0,0,.347656);cursor:pointer}</style><script>window.site_url = 'http://oslc.github.io/redesign/' || '/';
window.environment = 'production';
</script><!-- inlined base JS--><script type="text/javascript">
/**
* @preserve HTML5 Shiv 3.7.2 | @afarkas @jdalton @jon_neal @rem | MIT/GPL2 Licensed
*/
!function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=T.elements;return"string"==typeof e?e.split(" "):e}function a(e,t){var n=T.elements;"string"!=typeof n&&(n=n.join(" ")),"string"!=typeof e&&(e=e.join(" ")),T.elements=n+" "+e,s(t)}function o(e){var t=N[e[S]];return t||(t={},A++,e[S]=A,N[A]=t),t}function i(e,n,r){if(n||(n=t),b)return n.createElement(e);r||(r=o(n));var a;return a=r.cache[e]?r.cache[e].cloneNode():y.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),!a.canHaveChildren||v.test(e)||a.tagUrn?a:r.frag.appendChild(a)}function c(e,n){if(e||(e=t),b)return e.createDocumentFragment();n=n||o(e);for(var a=n.frag.cloneNode(),i=0,c=r(),l=c.length;l>i;i++)a.createElement(c[i]);return a}function l(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return T.shivMethods?i(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-:]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(T,t.frag)}function s(e){e||(e=t);var r=o(e);return!T.shivCSS||E||r.hasCSS||(r.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),b||l(e,r),e}function m(e){for(var t,n=e.getElementsByTagName("*"),a=n.length,o=RegExp("^(?:"+r().join("|")+")$","i"),i=[];a--;)t=n[a],o.test(t.nodeName)&&i.push(t.applyElement(u(t)));return i}function u(e){for(var t,n=e.attributes,r=n.length,a=e.ownerDocument.createElement(x+":"+e.nodeName);r--;)t=n[r],t.specified&&a.setAttribute(t.nodeName,t.nodeValue);return a.style.cssText=e.style.cssText,a}function d(e){for(var t,n=e.split("{"),a=n.length,o=RegExp("(^|[\\s,>+~])("+r().join("|")+")(?=[[\\s,>+~#.:]|$)","gi"),i="$1"+x+"\\:$2";a--;)t=n[a]=n[a].split("}"),t[t.length-1]=t[t.length-1].replace(o,i),n[a]=t.join("}");return n.join("{")}function f(e){for(var t=e.length;t--;)e[t].removeNode()}function h(e){function t(){clearTimeout(i._removeSheetTimer),r&&r.removeNode(!0),r=null}var r,a,i=o(e),c=e.namespaces,l=e.parentWindow;return!C||e.printShived?e:("undefined"==typeof c[x]&&c.add(x),l.attachEvent("onbeforeprint",function(){t();for(var o,i,c,l=e.styleSheets,s=[],u=l.length,f=Array(u);u--;)f[u]=l[u];for(;c=f.pop();)if(!c.disabled&&w.test(c.media)){try{o=c.imports,i=o.length}catch(h){i=0}for(u=0;i>u;u++)f.push(o[u]);try{s.push(c.cssText)}catch(h){}}s=d(s.reverse().join("")),a=m(e),r=n(e,s)}),l.attachEvent("onafterprint",function(){f(a),clearTimeout(i._removeSheetTimer),i._removeSheetTimer=setTimeout(t,500)}),e.printShived=!0,e)}var p="3.7.2",g=e.html5||{},v=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,y=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,E,S="_html5shiv",A=0,N={},b;!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",E="hidden"in e,b=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return"undefined"==typeof e.cloneNode||"undefined"==typeof e.createDocumentFragment||"undefined"==typeof e.createElement}()}catch(n){E=!0,b=!0}}();var T={elements:g.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output picture progress section summary template time video",version:p,shivCSS:g.shivCSS!==!1,supportsUnknownElements:b,shivMethods:g.shivMethods!==!1,type:"default",shivDocument:s,createElement:i,createDocumentFragment:c,addElements:a};e.html5=T,s(t);var w=/^$|\b(?:all|print)\b/,x="html5shiv",C=!b&&function(){var n=t.documentElement;return!("undefined"==typeof t.namespaces||"undefined"==typeof t.parentWindow||"undefined"==typeof n.applyElement||"undefined"==typeof n.removeNode||"undefined"==typeof e.attachEvent)}();T.type+=" print",T.shivPrint=h,h(t)}(this,document),function(e,t){"use strict";function n(t){var n=e.document.getElementsByTagName("script")[0],r=e.document.createElement("script");return r.src=t,n.parentNode.insertBefore(r,n),r}function r(t,n,r){var a=e.document.createElement("link"),o=n||e.document.getElementsByTagName("script")[0];return a.rel="stylesheet",a.href=t,a.media="only x",o.parentNode.insertBefore(a,o),setTimeout(function(){a.media=r||"all"}),a}function a(t){for(var n=e.document.getElementsByTagName("meta"),r,a=0;a<n.length;a++)if(n[a].name&&n[a].name===t){r=n[a];break}return r}function o(n,r,a){var o;if(r===t){var i="; "+e.document.cookie,c=i.split("; "+n+"=");return 2===c.length?c.pop().split(";").shift():null}if(r===!1&&(a=-1),a){var l=new Date;l.setTime(l.getTime()+24*a*60*60*1e3),o="; expires="+l.toGMTString()}else o="";e.document.cookie=n+"="+r+o+"; path=/"}e.console||(e.console={log:function(){}}),e.enhance={};var i=e.document,c=i.documentElement,l="production"===e.environment,s="combinedcss",m="enhancedjs",u=["enhanced"];enhance.loadJS=n,enhance.loadCSS=r,enhance.getMeta=a,enhance.cookie=o;var d=a(s);d&&l&&r(d.content);var f=function(t){if(t&&3===t.length){var n=e,a=!(!n.document.createElementNS||!n.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect||!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")||e.opera&&-1===navigator.userAgent.indexOf("Chrome")),i=function(e){var n=t[e&&a?0:e?1:2];r(n),o("grunticons",n,7)},c=new n.Image;c.onerror=function(){i(!1)},c.onload=function(){i(1===c.width&&1===c.height)},c.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}};enhance.grunticon=f;var h=a("grunticons");if(h&&l&&f(h.content.split(",")),"querySelector"in document&&"localStorage"in e&&"addEventListener"in e){c.className=c.className.replace(/(^|\s)base(\s|$)/,"$1$2")+" "+u.join(" ");var p=a(m);p&&n(p.content)}}(this);</script><noscript><link rel="stylesheet" href="http://oslc.github.io/redesign/assets/css/build/base.min.css"/><link rel="stylesheet" href="http://oslc.github.io/redesign/assets/icons/build/icons.fallback.css"/></noscript></head><body><div class="sticky-footer"><div><a href="#main" class="sr-only focusable">Skip to main content</a></div><header role="banner" class="banner knee-down"><div class="strip"><a id="navToggle" href="#nav" role="button" aria-label="Toggle Navigation" class="toggle image"> <i class="icon grunticon-navtoggle-menu"></i><span class="text"> 
Menu</span></a><div class="body"><a href="http://oslc.github.io/redesign/" class="flag image-link"><div class="image"><i class="icon block grunticon-logo-small"></i></div><div class="body"><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="icon block grunticon-wordmark-small ir">OSLC</abbr><span class="project-name">Public Redesign</span></span></div></a></div></div></header><div class="sticky-footer-body off-canvas-wrap"><main id="main" role="main" class="main has-secondary"><header class="header"><nav class="breadcrumbs"><a href="#" class="breadcrumb">Home</a>&nbsp;/&nbsp;<a href="#" class="breadcrumb">Resources</a>&nbsp;/&nbsp;<a href="#" class="breadcrumb">Integrating products with OSLC</a>&nbsp;/&nbsp;<a href="#" class="breadcrumb">Implementing an OSLC provider</a>&nbsp;/&nbsp;</nav><div id="pagetitle"><h1 class="title">Providing a delegated UI for selection and search</h1></div></header><section id="content"><div class="bar"><div class="copy"><p>Now that we have the basic services and resources defined for BugzillaChangeRequests (our Bugzilla-specific extension of OSLC ChangeRequests), our next step is to implement <a href="/resources/tutorials/oslc-primer/delegated-user-interface-dialogs/">delegated user interface (UI) dialogs</a> to allow the following actions from an OSLC Consumer:</p>
<ul>
<li>Search for and select Bugzilla bugs</li>
<li>Create a new bug in Bugzilla</li>
</ul>
<p>For example, a user of the NinaCRM product will be able to search for and add links to related bugs in Bugzilla without leaving the NinaCRM interface.</p>
<div class="callout-box">
<p>For more information on OSLC delegated UIs, see the <a href="http://open-services.net/bin/view/Main/OslcCoreSpecification#Delegated_User_Interface_Dialogs
">section about them in the OSLC core specification</a>.</p>
</div>


<p>Because delegated UI dialogs must accept user input and interact with Bugzilla to select or create bugs, they are more complex than collecting and describing bugs. Here&#39;s how we&#39;ll approach the process:</p>
<ol>
<li>See how OSLC4J helps provide delegated UI locations to the Service Provider document</li>
<li>Understand how to define a basic dialog with the J2Bugzilla API and generate the appropriate responses</li>
<li>Add methods to <strong>BugzillaChangeRequestService</strong> for the selection and creation of change requests</li>
<li>Add forms and JavaScript code to handle interacting with the consumer of the dialogs</li>
<li>Test the dialogs to ensure the appropriate response is given</li>
</ol>
<h2>Adding the location of delegated UI dialogs to Service Providers</h2>
<p>Because we&#39;re using OSLC4J, it&#39;s relatively trivial to add links to delegated UIs to our Service Provider documents.</p>
<p>Open <code>BugzillaChangeRequestService.java</code> in the <strong>org.eclipse.lyo.oslc4j.bugzilla</strong> package and search for <code>@OslcDialogs</code> (note the plural).</p>
<p>These use the imported annotations from OSLC4J: <code>org.eclipse.lyo.oslc4j.core.annotation.OslcDialog</code>, <code>org.eclipse.lyo.oslc4j.core.annotation.OslcDialogs;</code>, and <code>org.eclipse.lyo.oslc4j.core.annotation.OslcQueryCapability;</code></p>
<p>Here are the annotations for the selection dialog and the capability to query for bugs:</p>
<pre><code>@OslcDialogs(
{
    @OslcDialog
    (
         title = &quot;Change Request Selection Dialog&quot;,
         label = &quot;Change Request Selection Dialog&quot;,
         uri = &quot;/{productId}/changeRequests/selector&quot;,
         hintWidth = &quot;525px&quot;,
         hintHeight = &quot;325px&quot;,
         resourceTypes = {Constants.TYPE_CHANGE_REQUEST},
         usages = {OslcConstants.OSLC_USAGE_DEFAULT}
    )

})

@OslcQueryCapability
(
    title = &quot;Change Request Query Capability&quot;,
    label = &quot;Change Request Catalog Query&quot;,
    resourceShape = OslcConstants.PATH_RESOURCE_SHAPES + &quot;/&quot; + Constants.PATH_CHANGE_REQUEST,
    resourceTypes = {Constants.TYPE_CHANGE_REQUEST},
    usages = {OslcConstants.OSLC_USAGE_DEFAULT}
)</code></pre>
<p>As with BugzillaChangeRequests, with the appropriate annotations OSLC4J handles the conversion of this information to XML or JSON for you – no additional templating required.</p>
<p>You can explore <code>/src/main/webapp/cm/serviceprovider_html.jsp</code> to see how we add the links to these to the HTML representation of a Service Provider (under the <strong>Resource Selector Dialog</strong> heading).</p>
<p>With this enabled, we&#39;ve defined that the dialog for selecting or querying for bugs will be at the following URL (assuming your adapter is running at <code>localhost</code> and port <code>8080</code>):</p>
<pre><code>http://localhost:8080/OSLC4JBugzilla/services/{productID}/changeRequests/selector</code></pre>
<p>Next, we must create the dialog.</p>
<h2>Adding the dialog to search for and select bugs</h2>
<p>As with our methods for returning BugzillaChangeRequests, we add another method to our <strong>BugzillaChangeRequestService</strong> class to handle requests for a delegated UI to select bugs.</p>
<p>In our OSLC4J Bugzilla Adapter, open <code>BugzillaChangeRequestService.java</code> and search for the <code>changeRequestSelector()</code> method:</p>
<pre><code>@GET
@Path(&quot;selector&quot;)
@Consumes({ MediaType.TEXT_HTML, MediaType.WILDCARD })
public void changeRequestSelector(
    @QueryParam(&quot;terms&quot;)     final String terms,
    @PathParam(&quot;productId&quot;)  final String productId
    ) throws ServletException, IOException
{
    int productIdNum = Integer.parseInt(productId);
    httpServletRequest.setAttribute(&quot;productId&quot;, productIdNum);
    httpServletRequest.setAttribute(&quot;bugzillaUri&quot;, BugzillaManager.getBugzillaUri());
    httpServletRequest.setAttribute(&quot;selectionUri&quot;,uriInfo.getAbsolutePath().toString());

    if (terms != null ) {
        httpServletRequest.setAttribute(&quot;terms&quot;, terms);
        sendFilteredBugsReponse(httpServletRequest, productId, terms);

    } else {
        try {    
            RequestDispatcher rd = httpServletRequest.getRequestDispatcher(&quot;/cm/changerequest_selector.jsp&quot;); 
            rd.forward(httpServletRequest, httpServletResponse);

        } catch (Exception e) {
            throw new ServletException(e);
        }
    }

}</code></pre>
<p>In short, this method defines two things that could happen if you make a request to a URL with <code>/changeRequests/selector</code>:</p>
<ol>
<li>If the request URL <em>does not</em> have a <code>terms</code> parameter, we dispatch a JSP template (<code>changerequest_selector.jsp</code>) to display a form for the user to fill in the search terms and select a bug.</li>
<li>If the request <em>does</em> have a <code>terms</code> parameter, the request is an AJAX request coming from the delegated UI that is running in a user&#39;s web browser (code that we&#39;ll discuss below). We call the <code>sendFilteredBugsReponse()</code> method that performs a Bugzilla search (using the J2Bugzilla API) and returns the results in a compact JSON format.</li>
</ol>
<p>Let&#39;s explore the delegated UI to fill in search terms and select bugs in the JSP template.</p>
<h2>Creating the delegated UI for selection</h2>
<p>Open <code>/src/main/webapp/cm/changerequest_selector.jsp</code> and explore the contents.</p>
<p>The JSP page <code>changerequest_selector_dialog.jsp</code> provides the HTML and JavaScript for a Change Request Selector Dialog. There&#39;s a little bit of HTML, because the dialog is pretty simple.</p>
<p>Because a fair amount of JavaScript code is required to allow a user to enter search terms, display search results, allow the user to make a selection and then notify the delegated UI consumer that a selection has been made, we have stashed those methods in a <code>bugzilla.js</code> file that we load in the <code>&lt;head&gt;</code> of the returned HTML:</p>
<pre><code>&lt;script type=&quot;text/javascript&quot; src=&quot;../../../bugzilla.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>We&#39;ll explore the various JavaScript methods below.</p>
<h3>Allowing users to search for bugs</h3>
<p>In <code>changerequest_selector.jsp</code>, here&#39;s the form for the user to enter search terms:</p>
<pre><code>&lt;input type=&quot;search&quot; 
    style=&quot;width: 335px&quot; 
    id=&quot;searchTerms&quot; 
    placeholder=&quot;Enter search terms&quot; 
    autofocus&gt;
&lt;button 
    type=&quot;button&quot;
    onclick=&quot;search( &#39;&lt;%= selectionUri %&gt;&#39; )&quot;&gt;Search&lt;/button&gt;</code></pre>
<p>Note that when you click the <code>&lt;button&gt;</code>, we call the JavaScript function <code>search()</code>, which we define in the file <code>src/main/webapp/bugzilla.js</code>.</p>
<p>Open <code>bugzilla.js</code>. Near the top, explore the <code>search()</code> function.</p>
<pre><code>function search(baseUrl){
    var ie = window.navigator.userAgent.indexOf(&quot;MSIE&quot;);
    list = document.getElementById(&quot;results&quot;);
    list.options.length = 0;
    var searchMessage = document.getElementById(&#39;searchMessage&#39;);
    var loadingMessage = document.getElementById(&#39;loadingMessage&#39;);
    xmlhttp = new XMLHttpRequest();
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200) {
            // populate results
            txt = xmlhttp.responseText;
            resp = eval(&#39;(&#39; + txt + &#39;)&#39;);
            for( var x=0; x&lt;resp.results.length; x++ ) {
                var item=document.createElement(&#39;option&#39;);
                item.text = resp.results[x].title;
                item.value = resp.results[x].resource;
                if (ie &gt; 0) {
                     list.add(item); 
                } else {
                     list.add(item, null); 
                }
            }

            searchMessage.style.display = &#39;block&#39;;
            loadingMessage.style.display = &#39;none&#39;;
        }
    };
    terms = document.getElementById(&quot;searchTerms&quot;).value;
    xmlhttp.open(&quot;GET&quot;, baseUrl + &quot;?terms=&quot; + encodeURIComponent(terms), true);    
    searchMessage.style.display = &#39;none&#39;;
    loadingMessage.style.display = &#39;block&#39;;
    xmlhttp.send();
}</code></pre>
<p>In short, this function does the following:</p>
<ol>
<li>Removes any previous search results from the <code>&lt;select id=&quot;results&quot;&gt;</code> element</li>
<li>Creates an AJAX request </li>
<li>Get the search query from the value of the <code>&lt;input id=&quot;searchTerms&quot;&gt;</code> element.</li>
<li>Sends an AJAX request to <code>/changeRequests/selector</code> with a <code>terms=</code> parameter. Recall that this type of request to our adapter will run a search in Bugzilla and return the results in a JSON format.</li>
<li>A callback evaluates the search results with the <code>eval()</code> method, loops through the results, and adds each result as an <code>&lt;option&gt;</code> element to the <code>#results</code> element.</li>
<li>Reveals a loading message while making the request; hides the message when finished.</li>
</ol>
<p>Now in our delegated UI, users can search for bugs in Bugzilla, see a list of results, and select amongst them from a <code>&lt;select&gt;</code> element. Next, we will allow them to do something with their selection.</p>
<h3>Sending the selected bugs back to the OSLC consumer application</h3>
<p>Go back to the file <code>changerequest_selector.jsp</code>. Just below the <code>&lt;select id=&quot;results&quot;&gt;</code> element that will hold search results, you&#39;ll see the form <code>&lt;button&gt;</code>s to submit the selected bug or bugs:</p>
<pre><code>&lt;button style=&quot;float: right;&quot; type=&quot;button&quot;
  onclick=&quot;javascript: cancel()&quot;&gt;Cancel&lt;/button&gt;
&lt;button style=&quot;float: right;&quot; type=&quot;button&quot;
  onclick=&quot;javascript: select();&quot;&gt;OK&lt;/button&gt;</code></pre>
<p>When you click the <strong>OK</strong> button, we call the JavaScript function <code>select()</code>, which is also defined in the <code>bugzilla.js</code> file.</p>
<p>Open <code>bugzilla.js</code> and search for the <code>select()</code> function:</p>
<pre><code>function select(){
  list = document.getElementById(&quot;results&quot;);
  if( list.length&gt;0 &amp;&amp; list.selectedIndex &gt;= 0 ) {
    option = list.options[list.selectedIndex];
    sendResponse(option.text, option.value);
  }
}</code></pre>
<p>This method finds the bug that the user has selected (<code>list.options[list.selectedIndex]</code>) and sends the title (<code>option.text</code>) and URL (<code>option.value</code>) of the bug in a response to the original window (the <code>sendResponse()</code> method).</p>
<p>Because we&#39;re sending data from a delegated UI in one browser window back to another application with a different host and in a different window, we must use either the <a href="https://developer.mozilla.org/en-US/docs/DOM/window.postMessage"><code>window.postMessage</code></a> method (if supported) or via <code>window.name</code> variables otherwise.</p>
<p>Explore the <code>sendResponse()</code> method to see how we build the JSON response and determine which cross-window method to use to send it to the requesting application:</p>
<pre><code>function sendResponse(label, url) {
  var oslcResponse = &#39;oslc-response:{ &quot;oslc:results&quot;: [ &#39; +  
    &#39; { &quot;oslc:label&quot; : &quot;&#39; + label + &#39;&quot;, &quot;rdf:resource&quot; : &quot;&#39; + url + &#39;&quot;} &#39; + 
  &#39; ] }&#39;;

  if (window.location.hash == &#39;#oslc-core-windowName-1.0&#39;) {       
    // Window Name protocol in use
    respondWithWindowName(oslcResponse);
  } else if (window.location.hash == &#39;#oslc-core-postMessage-1.0&#39;) {
    // Post Message protocol in use
    respondWithPostMessage(oslcResponse);
  } 
}</code></pre>
<p>We determine whether or not we want to use Window Name or postMessage by looking at the <code>location.hash</code> value for the page: either <code>#oslc-core-windowName-1.0</code> or <code>#oslc-core-postMessage-1.0</code>. We do this because the <em>requesting client</em> is the application that must indicate which cross-domain method <em>it</em> supports; the client does so by requesting our delegated UI with the appropriate hash. We&#39;ll explore this later when we access this delegated UI in the NinaCRM application.</p>
<p>You can further explore the <code>respondWithPostMessage()</code> and <code>respondWithWindowName()</code> methods in <code>bugzilla.js</code> to see how we send the data to the requesting window – it&#39;s taken almost entirely from the examples in the OSLC Core specification.</p>
<div class="tip">
<p>
Note that the selection dialog above will show all Change Requests available for one Bugzilla Product. Some additional work could be done to make this more useful by doing some filtering up-front. For example, it might be useful to show only Change Requests that are assigned to the current user, or to prioritize recently created Change Requests.
</p>
</div>

<p>We&#39;ll put this delegated UI to use later when we <a href="/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/implementing-links-and-previews/">implement it in the NinaCRM sample application</a>.</p>
<p>Next, we&#39;ll create a delegated UI that will allow users to create new bugs in Bugzilla.</p>
</div></div></section><nav class="footer"><div class="grid collapsed blocks"><div class="column hand-full knee-half"><a href="#" class="sequence prev"> <div class="flag"><div class="image"><i class="icon grunticon-previous"></i></div><div class="body"><span class="label">Previous</span><span class="title">Providing a delegated UI for creating bugs</span></div></div></a></div><div class="column hand-full knee-half"><a href="#" class="sequence next"> <div class="flag reversed"><div class="body"><span class="label">Next</span><span class="title">Providing UI Previews</span></div><div class="image"><i class="icon grunticon-next"></i></div></div></a></div></div></nav><a role="button" aria-label="Close navigation" class="close-nav"></a></main><nav id="nav" role="navigation" data-whirligig="data-whirligig" class="nav has-secondary"><div class="controls hand-only enhanced-only"><div class="tabs"><a href="#main_menu" class="tab">Main</a><a href="#secondary_menu" class="tab active">Tutorial</a></div></div><div class="window"><div class="panels"><div id="main_menu" class="panel"><div data-prospectus="data-prospectus" data-manage-focus="false" class="menu primary"><div class="item desk-up"><a href="http://oslc.github.io/redesign/" class="image-link"><i class="icon grunticon-logo-med block"></i><span class="logo-text"><abbr title="Open Services for Lifecycle Collaboration" class="icon grunticon-wordmark-med ir">OSLC</abbr><span class="project-name">Public Redesign</span></span></a></div><div class="item"><gcse:searchbox-only></gcse:searchbox-only></div><ul class="items"><li><a href="http://oslc.github.io/redesign/" class="item">Home</a></li><li><a href="http://oslc.github.io/redesign/posts/" class="item">Posts</a></li><li class="current"><a href="http://oslc.github.io/redesign/samples/" class="item">Sample pages</a></li><!--li.item<div class="form login"><form action="#"><div class="control floatingLabels"><label for="login_username">Email or username</label><input type="text" required="required" name="username" id="login_username" class="text"/></div><div class="control floatingLabels"><label for="login_password">Password</label><input type="password" required="required" name="password" id="login_password" class="text"/></div><div class="actions"><button type="submit">Log in</button><div class="links"><a href="http://open-services.net/forums/member/register">Join us!</a><a href="http://open-services.net/forums/member/forgot_password">Forgot password?</a></div></div></form></div>--><!--li<a href="http://open-services.net/forums/member/profile" class="profile item"><span class="info">Hello,</span>Lee Reamsnyder</a>--><!--li<a href="http://open-services.net/?ACT=16" class="item">Log out</a>--></ul></div></div><div id="secondary_menu" class="panel"><div data-prospectus="data-prospectus" data-manage-focus="false" class="menu secondary inverted"><ul class="items"><li role="presentation"><span class="item heading">Integrating products with OSLC</span></li><li class="  "><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/" class="item">Overview</a></li><li class="  "><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/overview-of-oslc/" class="item">Overview of OSLC</a></li><li class="  "><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/running-the-examples/" class="item">Running the example applications</a></li><li class="  has-children"><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/" class="item">Implementing an OSLC provider</a><ul class="items"><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/planning-out-a-partial-implementation-of-oslc-cm/" class="item">Planning out a partial implementation of OSLC-CM </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-service-providers-and-catalogs/" class="item">Providing Service Providers and Catalogs </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-oslc-representations/" class="item">Providing OSLC representations of Bugzilla bugs </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-ui-previews/" class="item">Providing UI Previews </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-a-delegated-ui-for-selection/" class="item current">Providing a delegated UI for selection and search </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-a-delegated-ui-for-creation/" class="item">Providing a delegated UI for creating bugs </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/implementing-an-oslc-provider/providing-a-creation-factory/" class="item">Providing a creation factory </a></li></ul></li><li class="  has-children"><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/" class="item">Integrating with an OSLC provider</a><ul class="items"><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/sample-use-cases-for-oslc-consumers/" class="item">Sample use cases for an OSLC-CM Consumer </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/implementing-links-and-previews/" class="item">Implementing links and UI previews </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/making-incident-to-defect-linking-easy/" class="item">Implementing OSLC Delegated UIs </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/implementing-a-customers-to-notify-page/" class="item">Implementing a &quot;Customers to notify&quot; page </a></li><li><a href="http://open-services.net/resources/tutorials/integrating-products-with-oslc/integrating-with-an-oslc-provider/automated-bug-creation/" class="item">Implementing automated bug creation </a></li></ul></li></ul></div></div></div></div></nav></div><footer role="contentinfo" class="footer"><div class="grid pulled"><div class="column hand-full knee-minor"><p class="social"><a href="http://twitter.com/oslcNews"><i class="icon grunticon-social-twitter"><span class="sr-only">Follow us on Twitter</span></i></a><a href="http://www.youtube.com/user/OpenServicesDotNet"><i class="icon grunticon-social-youtube"><span class="sr-only">Watch our videos on YouTube</span></i></a><a href="http://oslc.github.io/redesign/"><i class="icon grunticon-social-github"><span class="sr-only">Report issues on Github</span></i></a><a href="http://www.linkedin.com/groups/OSLC-Open-Services-Lifecycle-Collaboration-3957829"><i class="icon grunticon-social-linkedin"><span class="sr-only">Follow us on LinkedIn</span></i></a><a href="https://plus.google.com/u/0/107747465325293070028/posts"><i class="icon grunticon-social-googleplus"><span class="sr-only">Add us on Google Plus</span></i></a></p></div><div class="column hand-full knee-major"><ul class="inline"><li class="item"><a href="https://github.com/OSLC/redesign/issues">Issues</a></li><li class="item"><a href="http://open-services.net">OSLC Home</a></li><li class="item"><a href="mailto:webmaster@open-services.net">Feedback</a></li></ul></div></div><p class="copyright"><small>All content <a rel="license" href="http://creativecommons.org/licenses/by/3.0/us/")>Creative Commons Attribution 3.0 US</a> except where noted otherwise.</small></p></footer></div></body><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-24416914-4', 'oslc.github.io');
ga('send', 'pageview');
</script></html>